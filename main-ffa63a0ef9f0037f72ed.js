"use strict";(self.webpackChunkgarden_task=self.webpackChunkgarden_task||[]).push([[179],{426:(t,e,s)=>{s.d(e,{Z:()=>p});var i=s(81),n=s.n(i),o=s(645),a=s.n(o),r=s(667),h=s.n(r),c=new URL(s(147),s.b),d=a()(n()),l=h()(c);d.push([t.id,"@font-face {\n    font-family: 'Larceny';\n    src: url("+l+") format('ttf');\n}\n\nhtml,\nbody {\n    margin: 0px 0px 0px 0px;\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n}\n\n.overlay {\n    width: 100%;\n    position: absolute;\n    background: none;\n    top: 0;\n    left: 0;\n    margin: 0 0 0 0;\n    height: 0px;\n}\n\n#overlay {\n    width: 100%;\n    position: absolute;\n    text-align: center;\n    font-family: Larceny;\n    font-size: 5em;\n}\n\n#textBanner {\n    position: absolute;\n    width: 100%;\n}\n\n#controlsBanner {\n    width: 100vw;\n    height: 100vh;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n    background-color: rgba(0,0,10,.3);\n    color: white;\n    z-index: 2;\n}\n\n#gameOver {\n    width: 100vw;\n    height: 100vh;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n    background-color: rgba(0,0,10,1);\n}\n\n#gameOverInfo {\n    margin: 0 0 0 0;\n    font-size: 10vh;\n    color: red;\n}\n\n#gameOverTitle {\n    color: red;\n    font-size: 40vh;\n    margin: 0 0 0 0;\n}\n\n#container {\n    position: relative;\n}",""]);const p=d},269:(t,e,s)=>{var i=s(379),n=s.n(i),o=s(795),a=s.n(o),r=s(569),h=s.n(r),c=s(565),d=s.n(c),l=s(216),p=s.n(l),m=s(589),u=s.n(m),w=s(426),y={};y.styleTagTransform=u(),y.setAttributes=d(),y.insert=h().bind(null,"head"),y.domAPI=a(),y.insertStyleElement=p(),n()(w.Z,y),w.Z&&w.Z.locals&&w.Z.locals;var _=s(687);const f=function(t,e,s){const i=new _.uT({mass:e});return i.addShape(t),i.position.copy(s),i.linearDamping=.4,i.updateSolveMassProperties(),i};class v{constructor(t,e,s,i,n){const o=new _.Ab(i,i,n,12),a=new f(o,e,s);t.add(a)}}var g=s(35),b=s.n(g);function x(t,e){return Math.random()*(e-t)+t}const A=new _.AO(0,.002);class k{constructor(t){this.velocity=new _.AO(x(-1,1),0,x(-1,1)).scale(.1),this.position=t.clone(),this.lifespan=100}update(){this.velocity.vadd(A,this.velocity),this.position.vadd(this.velocity,this.position),this.lifespan-=2}draw(t){const e=Math.max(0,this.lifespan/255);t.push(),t.fill(255,0,0),t.translate(...this.position.toArray()),t.box(e,e,e),t.pop()}get dead(){return this.lifespan<0}}class O{constructor(t){this.particles=[],this._enabled=t}set enabled(t){this._enabled=t}update(t){for(let t=0;t<this.particles.length;t++){const e=this.particles[t];e.update(),e.dead&&this.particles.splice(t,1)}this._enabled&&this.particles.length<200&&this.particles.push(new k(t))}draw(t){for(let e=0;e<this.particles.length;e++)this.particles[e].draw(t)}}const M=[1,1,1];class T{constructor(t){this._body=t}getMatrix(){return(this._body.mass>0||!this._cachedTransformMatrix)&&(this._cachedTransformMatrix=function(t,e,s){const i=[],n=e[0],o=e[1],a=e[2],r=e[3],h=n+n,c=o+o,d=a+a,l=n*h,p=n*c,m=n*d,u=o*c,w=o*d,y=a*d,_=r*h,f=r*c,v=r*d,g=s[0],b=s[1],x=s[2];return i[0]=(1-(u+y))*g,i[1]=(p+v)*g,i[2]=(m-f)*g,i[3]=0,i[4]=(p-v)*b,i[5]=(1-(l+y))*b,i[6]=(w+_)*b,i[7]=0,i[8]=(m+f)*x,i[9]=(w-_)*x,i[10]=(1-(l+u))*x,i[11]=0,i[12]=t[0],i[13]=t[1],i[14]=t[2],i[15]=1,i}(this._body.position.toArray(),this._body.quaternion.toArray(),M)),this._cachedTransformMatrix}}class L{constructor(t,e,s,i,n){const o=new _.xu(new _.AO(.35,.93,.7)),a=new f(o,300,new _.AO(e.x,e.y-1.86,e.z));a.fixedRotation=!0,a.allowSleep=!1,a.updateMassProperties(),t.add(a),this._body=a,this.alive=!0,this.movementSpeed=s,this.seekPoint=new _.AO,a.addEventListener("collide",(t=>{if(t.body.velocity.lengthSquared()<800)return;const e=t.body.position.vsub(a.position);e.normalize(),a.applyForce(e.scale(-1e6-1e6*Math.random()*.4)),this.alive&&(a.fixedRotation=!1,this.alive=!1,a.updateMassProperties(),this.bloodSystem.enabled=!0)})),this.enemyModel=i,this.enemySkin=n,this._matrixTracker=new T(a),this.bloodSystem=new O(!1)}withinRangeOfPoint(t){return this._body.position.distanceSquared(this.seekPoint)<Math.pow(t,2)}_updateAI(){const t=this.seekPoint.vsub(this._body.position);t.set(t.x,0,t.z).normalize();const e=Math.atan2(t.z,t.x);this._body.quaternion.setFromAxisAngle(_.AO.UNIT_Y,-e+Math.PI/2);const s=this._body.velocity;s.set(t.x*this.movementSpeed,s.y,t.z*this.movementSpeed)}update(){this.bloodSystem.update(this._body.position),this.alive&&this._updateAI()}draw(t){t.push(),t.applyMatrix(this._matrixTracker.getMatrix()),t.texture(this.enemySkin),t.model(this.enemyModel),t.pop(),this.bloodSystem.draw(t)}}const E=document.getElementById("controlsBanner");class I{constructor(t){this.xRotation=0,this.yRotation=0,this.forward=new _.AO,this.up=new _.AO,this.position=new _.AO,document.addEventListener("mousemove",(t=>{if(!this.pointerLock)return;const{movementX:e,movementY:s}=t;this.yRotation-=.002*e,this.xRotation+=.002*s,this.xRotation=Math.max(-Math.PI/2,Math.min(Math.PI/2,this.xRotation))}));const e=()=>{this.pointerLock||document.body.requestPointerLock()};t.elt.addEventListener("click",e),E.addEventListener("click",e),document.addEventListener("pointerlockchange",(()=>{document.pointerLockElement?this.pointerLock=!0:this.pointerLock=!1}))}set fov(t){this.fovy=t,this._cachedWidth=0}update(t){t.width===this._cachedWidth&&b().height===this._cachedHeight||(t.perspective(this.fovy,t.width/t.height,.01,250),this._cachedWidth=t.width,this._cachedHeight=t.height);const e=(new _._f).setFromEuler(0,this.yRotation,this.xRotation,"XYZ");e.vmult(_.AO.UNIT_X,this.forward),e.vmult(_.AO.UNIT_Y,this.up);const s=this.position.vadd(this.forward.scale(1e4));t.camera(this.position.x,this.position.y,this.position.z,s.x,s.y,s.z,this.up.x,this.up.y,this.up.z)}drawControlsBanner(){E.style.display=this.pointerLock?"none":"flex"}}const z=["help me!\ni fear the zombies!","thank you,\nkind stranger!","i am in\ntree-mendous-danger","they didn't want a\npeace tree-ty"],R=new _.AO(0,0,0),S=[new _.AO(10,0,-40),new _.AO(-20,0,-40),new _.AO(0,0,40),new _.AO(-10,0,50)],P=document.getElementById("textBanner");function j(t){P.innerHTML=`Destroy zombies before they reach the sentient tree!<br>${t} KILLED`}class B{constructor(t,e,s){this.createEnemy=e,this.enemies=[],this.onGameOver=s,this.physWorld=t,this.killCount=0,j(this.killCount),this.tempJitter=new _.AO,this._treeQuote=z[0]}update(t,e){if(this.enemies.forEach((e=>{var s;e.alive?!0===e.withinRangeOfPoint(6)&&(s=this.killCount,document.getElementById("gameOver").style.display="flex",document.getElementById("gameOverInfo").innerHTML=`A zombie reached the tree.<br>YOU KILLED ${s}!`,P.style.display="none",document.exitPointerLock(),this.onGameOver()):e.queuedForDeath||(e.queuedForDeath=!0,setTimeout((()=>{this.physWorld.remove(e._body),this.enemies=this.enemies.filter((t=>t!=e))}),2500),j(++this.killCount),this._treeQuote=t.random(z))})),2+Math.floor(e/9)>this.enemies.length){const t=S[Math.floor(Math.random()*S.length)];this.tempJitter.set(5*(Math.random()-.5),0,5*(Math.random()-.5));const s=2+Math.floor(e/7.5);this.enemies.push(this.createEnemy(t.vadd(this.tempJitter),s))}}draw(t,e){this.enemies.forEach((e=>{e.update(),e.draw(t)}));const s=e.position.vsub(R),i=Math.atan2(s.x,s.z);t.push(),t.textAlign(t.CENTER,t.BOTTOM),t.angleMode(t.RADIANS),t.textSize(4),t.translate(...R.vadd(new _.AO(0,-20,0)).toArray()),t.rotateY(i),t.text(this._treeQuote,0,0),t.pop()}}class D{constructor(){const t=new _.q3;t.gravity.set(0,10,0),t.broadphase=new _.KK,t.solver.iterations=20,t.defaultContactMaterial.contactEquationStiffness=1e7,t.defaultContactMaterial.contactEquationRelaxation=5,this.world=t}update(){this.world.step(1/60)}add(t){this.world.addBody(t)}remove(t){this.world.removeBody(t)}}class C{constructor(t,e){const s=new _.JO,i=new f(s,0,e);i.quaternion.setFromAxisAngle(new _.AO(1,0,0),Math.PI/2),t.add(i)}}const q=new _.aL(.2);class W{constructor(t,e,s){this._flowerModel=e,this._paletteTexture=s,this._physWorld=t,this._projectiles=[]}fire(t,e,s){this._projectiles.length>12&&this._physWorld.remove(this._projectiles.shift().body);const i=new f(q,40,t);e.normalize(),i.velocity=i.velocity.vadd(e.scale(45)),i.position=t.vadd(i.velocity.scale(.04)),i.velocity.vadd(s.scale(.01),i.velocity),i.angularDamping=.99,i.linearDamping=.2,i.angularVelocity=new _.AO(x(-16,16),x(-16,16),x(-16,16)),i.updateMassProperties(),this._physWorld.add(i),this._projectiles.push({body:i,matrixTracker:new T(i)})}draw(t){this._projectiles.forEach((e=>{t.push(),t.applyMatrix(e.matrixTracker.getMatrix()),t.scale(.24),t.texture(this._paletteTexture),t.model(this._flowerModel),t.pop()}))}}const Y=new _.aL(1.125);class N{constructor(t,e,s,i){this._camera=s;const n=new f(Y,30,new _.AO(e.x,e.y-2.25,e.z+1.125));n.allowSleep=!1,n.linearDamping=.9,n.angularDamping=0,n.updateMassProperties(),t.add(n),this._body=n,this._shooter=i,window.addEventListener("click",(()=>{this._shooter.fire(this._body.position,this._camera.forward,n.velocity)})),this._forward=new _.AO,this._right=new _.AO;const o=new _.AO;this._canJump=!0,n.addEventListener("collide",(t=>{const{contact:e}=t;e.bi.id===n.id?e.ni.negate(o):o.copy(e.ni),console.log(o.dot(_.AO.UNIT_Y)),o.dot(_.AO.UNIT_Y)<-.5&&(this._canJump=!0)}))}update(t){this._forward.set(Math.cos(-this._camera.yRotation),0,Math.sin(-this._camera.yRotation)),this._forward.normalize(),this._forward.cross(_.AO.UNIT_Y,this._right);const e=this._body.velocity;e.set(0,this._body.velocity.y,0),t.keyIsDown(87)?e.addScaledVector(1*t.deltaTime,this._forward,e):t.keyIsDown(83)&&e.addScaledVector(-1*t.deltaTime,this._forward,e),t.keyIsDown(65)?e.addScaledVector(-1*t.deltaTime,this._right,e):t.keyIsDown(68)&&e.addScaledVector(1*t.deltaTime,this._right,e),t.keyIsDown(32)&&this._canJump&&(this._canJump=!1,e.addScaledVector(-6,_.AO.UNIT_Y,e))}draw(t){const e=this._body.position;this._camera.position.set(e.x,e.y-.5,e.z),this._shooter.draw(t)}}class U{constructor(t,e,s,i,n){const o=function(t){const e=[];t.vertices.forEach((t=>{e.push(t.x,t.y,t.z)}));const s=[];for(let e=0;e<t.faces.length;e++)s.push(t.faces[e][0],t.faces[e][1],t.faces[e][2]);return new _.np(e,s)}(i),a=new f(o,0,e);a.updateAABB(),t.add(a),this._matrixTracker=new T(a),this._mesh=s,this._tex=n}draw(t){t.push(),t.applyMatrix(this._matrixTracker.getMatrix()),t.texture(this._tex),t.model(this._mesh),t.pop()}}const Z=(t,e)=>new Promise(((s,i)=>{t.loadModel(e,!1,s,i)})),F=(t,e)=>Promise.resolve(t.loadImage(e));class J{constructor(t,e){this._phys=new D,this._cam=new I(e),this._cam.fov=t.radians(75),this._sceneReady=!1,this._p=t}setup(){var t;this.objects=[new C(this._phys,new _.AO),new v(this._phys,0,_.AO.ZERO,3,20)],Promise.all([F(this._p,"./assets/resurrect-64-1x.png"),Z(this._p,"./assets/island.obj"),Z(this._p,"./assets/island_fence_collide.obj"),Z(this._p,"./assets/basicCharacter.obj"),F(this._p,"./assets/skin_exclusiveZombie.png"),Z(this._p,"./assets/flower.obj"),(t=this._p,"./assets/Larceny.ttf",Promise.resolve(t.loadFont("./assets/Larceny.ttf")))]).then((t=>{const[e,s,i,n,o,a,r]=t;this._p.textFont(r,40),this.objects.push(new U(this._phys,_.AO.ZERO,s,i,e)),this.objects.push(new B(this._phys,((t,e)=>new L(this._phys,t,e,n,o)),(()=>{this._sceneReady=!1}))),this.objects.push(new N(this._phys,new _.AO(10,0,0),this._cam,new W(this._phys,a,e)))})).then((()=>this._sceneReady=!0)),this._clock=0}draw(){this._sceneReady&&(this._p.background(195,233,247),this._phys.update(this._p.deltaTime/1e3),this._p.ambientLight(100,109,117),this._p.directionalLight(245,234,215,50,80,-1),this._p.specularMaterial(250),this._p.shininess(50),this.objects.forEach((t=>t.update&&t.update(this._p,this._clock))),this._cam.update(this._p),this.objects.forEach((t=>t.draw&&t.draw(this._p,this._cam))),this._cam.drawControlsBanner(),this._clock+=this._p.deltaTime/1e3)}}new(b())((function(t){t.setup=()=>{const e=t.createCanvas(t.windowWidth,t.windowHeight,t.WEBGL);e.parent("sketch-holder"),t.noStroke();const s=new J(t,e);s.setup(),t.draw=()=>s.draw()},t.windowResized=()=>{t.resizeCanvas(t.windowWidth,t.windowHeight)}}))},147:(t,e,s)=>{t.exports=s.p+"Larceny-ab733175f5e35a601c92.ttf"}},t=>{t.O(0,[995],(()=>(269,t(t.s=269)))),t.O()}]);